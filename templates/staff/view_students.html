{% extends "staff/head_foot.html" %}

{% block content %}
<center>
    
    <div class="container py-4" style="margin-top: 5em; padding-bottom: 2vw;">
    {% if messages %}
        <div style="margin-bottom: 1rem;">
            {% for message in messages %}
            <div class="alert {% if 'error' in message.tags %}alert-danger{% else %}alert-success{% endif %}">
                {{ message }}
                </div>
            {% endfor %}
        </div>
    {% endif %}
    <h2 class="text-center mb-4">Verified Students in Your Department</h2>

    {% if students %}
<div class="row mb-3">
    <div class="col-md-6 offset-md-3">
        <input type="text" id="studentSearch" class="form-control"
               placeholder="Search students by name, reg no, department, etc...">
    </div>
</div>

<div class="row" id="studentCards">
    {% for student in students %}
    <div class="col-12 col-md-6 col-lg-12 mb-4 student-card">

        <div class="card shadow-sm h-100 border-danger">
            <div class="card-body">

                <h5 class="card-title text-primary">
                    {{ student.name }}
                </h5>
                
                <p class="mb-1"><strong>Reg No:</strong> {{ student.reg_no }}</p>
                <p class="mb-1"><strong>Department:</strong> {{ student.dep.dep|default:"N/A" }}</p>
                <p class="mb-1"><strong>Course:</strong> {{ student.course.course|default:"N/A" }}</p>
                <p class="mb-1"><strong>Semester:</strong> {{ student.sem }}</p>
                
                <hr>
                
                <p class="mb-1">
                    <strong>ğŸ“ Student:</strong> {{ student.pho }}
                </p>
                <p class="mb-1 text-muted">
                    ğŸ“§ {{ student.login_info.email }}
                </p>

                <p class="mb-2">
                    <strong>Blood:</strong>
                    <span class="badge bg-primary">{{ student.blood_type }}</span>
                </p>
                
                <p class="mb-2">
                    <strong>Address:</strong><br>
                    {{ student.address }}
                </p>

                <hr>

                <p class="mb-1"><strong>Guardian:</strong></p>
                {% if student.parent_1 %}
                    <p class="mb-1">{{ student.parent_1.Guadin_Name }}</p>
                    <small class="text-muted d-block">
                        ğŸ“ {{ student.parent_1.Guadin_phone_Number }}<br>
                        ğŸ“§ {{ student.parent_1.Guadin_email }}
                    </small>
                    <a href="{% url 'view_gud_data' student.id student.course student.sem %}"
                    class="text-danger small">
                    View more
                    </a>
                {% else %}
                <span class="text-muted">Not Provided</span>
                {% endif %}

            </div>

            <!-- Card Footer Actions -->
            <div class="card-footer bg-white">
                <div class="d-grid gap-2">

                    <a href="{% url 'view_student_all_attendance' student.id %}"
                    class="btn btn-outline-success btn-sm">
                        <i class="bi bi-eye"></i> View Attendance
                    </a>

                    <div class="btn-group w-100">
                        <button class="btn btn-outline-primary btn-sm dropdown-toggle"
                                data-bs-toggle="dropdown">
                            Status
                        </button>
                        <ul class="dropdown-menu w-100">
                            <li>
                                <a class="dropdown-item text-danger"
                                   href="{% url 'droup_out' student.id year course %}"
                                   onclick="return confirm('Mark as Dropped Out?');">
                                   Drop Out
                                </a>
                            </li>
                            <li>
                                <a class="dropdown-item text-warning"
                                href="{% url 'temp_discontinue' student.id year course %}"
                                onclick="return confirm('Temporary Discontinuation?');">
                                Temp Discontinue
                                </a>
                            </li>
                        </ul>
                    </div>

                    <a href="{% url 'individual_report_card' student.id %}"
                    class="btn btn-outline-success btn-sm">
                        <i class="bi bi-file-earmark-text"></i> Report Card
                    </a>

                    <a href="{% url 'edit_student_details' student.id 0 %}"
                       class="btn btn-warning btn-sm">
                        Edit Student
                    </a>

                </div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="alert alert-info text-center" style="padding-bottom: 17vw;">
    No verified students found in your department.
</div>
{% endif %}

</div>

</center>
<style>
    .card-title {
    font-weight: 600;
}

.student-card {
    transition: transform 0.2s ease;
}

.student-card:hover {
    transform: translateY(-4px);
}

    .btn-sm {
        font-size: 13px;
    }

    
</style>


<script>
    document.addEventListener("DOMContentLoaded", function () {
    const searchInput = document.getElementById("studentSearch");
    const cards = document.querySelectorAll(".student-card");

    searchInput.addEventListener("input", function () {
        const query = this.value.toLowerCase();

        cards.forEach(card => {
            const content = card.textContent.toLowerCase();
            card.style.display = content.includes(query) ? "block" : "none";
        });
    });
});
</script>

{% endblock %}
